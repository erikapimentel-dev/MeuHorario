// schema.prisma (versão corrigida e recomendada)
datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

generator client {
  provider = "prisma-client-js"
}

enum DiaDaSemana {
  SEGUNDA
  TERCA
  QUARTA
  QUINTA
  SEXTA
  SABADO
  DOMINGO
}

// AJUSTE: Renomeei os valores do enum para serem válidos
enum PeriodoAula {
  P1
  P2
  P3
  P4
  P5
  P6
  P7
  P8
  P9
}

model Professor {
  id               Int               @id @default(autoincrement())
  nome             String
  disciplinas      Disciplina[]
  disponibilidades Disponibilidade[]
  createdAt        DateTime          @default(now())
  updatedAt        DateTime          @updatedAt
}

model Disponibilidade {
  id          Int         @id @default(autoincrement())
  professorId Int
  diaDaSemana DiaDaSemana
  periodo     PeriodoAula // Agora usa o enum corrigido
  professor   Professor   @relation(fields: [professorId], references: [id])
  createdAt   DateTime    @default(now())
  updatedAt   DateTime    @updatedAt
}

model Turma {
  id          Int          @id @default(autoincrement())
  nome        String
  disciplinas Disciplina[]
  createdAt   DateTime     @default(now())
  updatedAt   DateTime     @updatedAt
}

model Disciplina {
  id           Int       @id @default(autoincrement())
  nome         String
  cargaHoraria Int
  professorId  Int
  turmaId      Int
  professor    Professor @relation(fields: [professorId], references: [id])
  turma        Turma     @relation(fields: [turmaId], references: [id])
  // CORREÇÃO: Removi a linha "periodos" que sobrou do schema antigo
  horarios     Horario[]
  createdAt    DateTime  @default(now())
  updatedAt    DateTime  @updatedAt
}

// MUDANÇA: O antigo "Periodo" agora é "Horario"
model Horario {
  id           Int         @id @default(autoincrement())
  disciplinaId Int
  diaDaSemana  DiaDaSemana
  periodo      PeriodoAula // Usa o enum corrigido
  disciplina   Disciplina  @relation(fields: [disciplinaId], references: [id])
  createdAt    DateTime    @default(now())
  updatedAt    DateTime    @updatedAt
}